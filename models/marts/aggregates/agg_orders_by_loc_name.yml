version: 2

models:
  - name: agg_orders_by_loc_name
    description: "Aggregated count of each type of order by location name."
    columns:
      - name: location_name
        description: "Name of the location."
      - name: order_type
        description: "Type of order: food_only, drink_only, food_and_drink, neither."
      - name: order_count
        description: "Total number of orders of this type at this location."
    tests:
      - dbt_utils.expression_is_true:
          expression: "sum(order_count) > 0"
          config:
            severity: error 